#!/bin/sh -e

# called from dpkg with:
#   $1    package name
#   $2    full path to .deb postinst script (blank if there is none in .deb)
#   $3... parameter list normally passed as $1... per debian documentation
#         See: http://www.debian.org/doc/debian-policy/ch-maintainerscripts.html
# NB: this script *must* run $2 with $3... parameters at some point

. @PREFIX@/bin/init.sh

echo "postinst for package '$1'"
pkg=$1
shift;

if [ "$2" = "configure" ]; then
    echo "Cleaning up .la files being installed:"
    for lafile in `grep '\.la$' "/sw/var/lib/dpkg/info/$pkg.list"`; do
	if [ -f "$lafile" ] && [ ! -h "$lafile" ]; then
	    echo '  perl -pi -e "s/^(dependency_libs)=.*/\1='"''"'/" "'$lafile'" || true'
#	    perl -pi -e "s/^(dependency_libs)=.*/\1=''/" "$lafile" || true
	fi
    done
    echo "dry-run-only debug"
fi

[ -z $1 ] || "$@"
